# Lab: Manage a v-Core-based Azure Cosmos DB for MongoDB account

## Introduction

### Objectives

### Build your own lab environment

If you need to build your own lab environment, you need the following components and resource access.

- **Visual Studio Code**: Ensure Visual Studio Code is installed on your machine.
- **Azure Subscription**: Have access to an Azure Subscription for creating necessary resources.

## Clone the Repository

- Open **Visual Studio Code**.
- Press **CTRL+SHIFT+P** to open the command palette.
- Run **Git: Clone** and clone the repository `https://github.com/MicrosoftLearning/mslearn-cosmosdb-mongodb-vcore.git`.
- Navigate to the cloned repository directory.
- Right-click on the **04-vector-search** folder and select **Open in integrated Terminal**.

## Create Azure Resources

You need access to the following Azure resources for this lab:

- v-Core-based Azure Cosmos DB for MongoDB account

You can create these resources via the *Azure portal* or use the ***create-azure-resources.ps1*** PowerShell script with the ***.env** file. Don't use existing production resources for this lab or any lab.

### Use the .env file

*This file must either be populated manually, or by the create-azure-resources.ps1 script before you can run your application, since it contains the connection information to your Azure resources.*

This file is both used to retrieve and store the necessary environment variables for both the PowerShell script and the vector search application APIs. It's the easiest way to prepopulate your resource information. The file is used to store the environment variables for your Azure Cosmos DB and Azure OpenAI account.

If you already have a Resource Group or a v-Core-based Azure Cosmos DB for MongoDB account that you would like to use, just fill in those values in the .env file. By default, the *create-azure-resources.ps1* script uses this file to retrieve the necessary environment variables.  

To learn more about the ***.env*** file and its parameters, review the [***.env*** file documentation](./00-env-file.md).

### Use the create-azure-resources.ps1 script

This script creates the necessary Azure resources for this lab. It gives you the flexibility to create some or all of the resources required for this lab. You can either run the script as is or modify it to suit your needs.  

The script has a rich set of parameters to help you customize the resources to be created. It also uses an ***.env*** file to retrieve and store the necessary environment variables for both the PowerShell script and the vector search application APIs.  

To learn more about the PowerShell script and its parameters, reviewing the [***create-azure-resources.ps1*** documentation](./00-powershell-script.md).

To create the necessary Azure resources for this lab, run the following command in the integrated terminal. If you aren't creating all resources, don't forget to use the *skip creating* parameters for the resources you don't want to create.

```powershell
az login
./create-azure-resources.ps1
```

> [!NOTE]
> Make sure the tenant, location and subscription you use allows for the creation of the necessary resources. Not all locations and subscriptions might allow or support the creation of all the required resources needed for this lab. If you encounter any issues, please reach out to your Azure Administrator.

Copy and save the environment variables returned by the script in case you need them later. You can verify the resources created in the Azure portal. Finally, ensure that the **.env** file is populated with the resource information.

> [!NOTE]
> The v-Core-based Azure Cosmos DB for MongoDB account will need a firewall rule to allow access from your current public IP address.  If your Azure Cosmos DB account was generated by the *create-azure-resources.ps1* script, it should have created the firewall rule for you.  Check the existing firewall rules under the ***Networking*** *Setting* section of the *Azure Cosmos DB Account*.  If you are not sure what your current public IP address is, you can use the following command to find out:

> ```powershell
> Invoke-RestMethod -Uri 'http://ipinfo.io/ip' -Method Get
> ```

Once the resources are created and your **.env** file is populated with the resource information, you can proceed to the next step.

## Scale a v-Core-based Azure Cosmos DB for MongoDB account

## Backup and restore a v-Core-based Azure Cosmos DB for MongoDB account

## Monitor a v-Core-based Azure Cosmos DB for MongoDB account

## Clean Up

After completing the lab exercises, it's important to clean up any resources you created to avoid incurring unnecessary costs. Here's how:

1. **Azure Portal**: Sign in to the [Azure portal](https://portal.azure.com).

1. **Delete Resource Group**: If you created a new resource group for this lab, navigate to *Resource groups*, find your group, and delete it. This action removes all the resources contained within it, including your Azure Cosmos DB instance and any Azure OpenAI resources.

1. **Manually Delete Individual Resources**: If you added resources to an existing group, you need to delete each resource individually. Navigate to each resource created for this lab (for example, Azure Cosmos DB for MongoDB, Azure OpenAI account) and delete them.

1. **Verify Deletion**: Confirm all resources you no longer need were successfully removed and are no longer listed in your Azure portal.

1. **Review Billing**: Check your Azure billing section to ensure no unexpected charges are incurred, verifying that all unwanted resources were successfully deleted.

This cleanup process helps maintain your Azure account organized and free from unnecessary charges, ensuring you only pay for resources you actively use.

# Conclusion